<!DOCTYPE html>
<html lang="en-US">
  <head>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link href="../../assets/styles/article.css" rel="stylesheet" type="text/css" /> 
    <title>CS 544: Project 1</title>
    <link href="prj1/hl-fine_blue.css" rel="stylesheet"/>
  </head>
  <body>
    <nav>
      <ul>
	<li><a href="../../index.html" class="material-icons">house</a></li>
	<li><a href="../../docs/index.html">Docs</a></li>
	<li><a href="../../exams-quizzes/index.html">Exams &amp; Quizzes</a></li>
	<li><a href="../../exercises/index.html">Exercises</a></li>
	<li><a href="../../hws/index.html">Homeworks</a></li>
	<li><a href="../../misc/index.html">Misc</a></li>
	<li><a href="../../projects/index.html">Projects</a></li>
	<li><a href="../../slides/index.html">Slides</a></li>
      </ul>
    </nav>
    <div class="content">
      <section data-coord="prj1.umt:1:0"><h1 data-coord="prj1.umt:1:0">Project 1</h1><p data-coord="prj1.umt:3:0"><strong data-coord="prj1.umt:3:0">Due</strong>: Feb 17 by 11:59p
</p><p data-coord="prj1.umt:5:0"><strong data-coord="prj1.umt:5:0">Important Reminder</strong>: As per the course <em data-coord="prj1.umt:5:110"><a href="../../misc/academic-honesty-statement/academic-honesty-policy.html" data-coord="prj1.umt:5:110">Academic Honesty Statement</a></em>,
cheating of any kind will minimally result in receiving an F letter
grade for the entire course.
</p><p data-coord="prj1.umt:9:0">This document first provides the aims of this project.  It then lists
the requirements as explicitly as possible.  This is followed by a log
which should help you understand the requirements.  Finally, it
provides some hints as to how those requirements can be met.
</p><section data-coord="prj1.umt:14:0"><h2 data-coord="prj1.umt:14:0">Aims</h2><p data-coord="prj1.umt:17:0">The aims of this project are as follows:
</p><ul data-coord="prj1.umt:19:0"><li data-coord="prj1.umt:19:0"><p data-coord="prj1.umt:19:4">To ensure that you have set up your VM as specified in the
<em data-coord="prj1.umt:19:104"><a href="../../misc/vm-setup/vm-setup.html" data-coord="prj1.umt:19:104">VM Setup</a></em> and
<em data-coord="prj1.umt:19:162"><a href="../../misc/git-setup/git-setup.html" data-coord="prj1.umt:19:162">Git Setup</a></em>
documents.
</p></li><li data-coord="prj1.umt:24:0"><p data-coord="prj1.umt:24:4">To get you to write a non-trivial JavaScript program.
</p></li><li data-coord="prj1.umt:26:0"><p data-coord="prj1.umt:26:4">To allow you to familiarize yourself with the programming
environment you will be using in this course.
</p></li><li data-coord="prj1.umt:29:0"><p data-coord="prj1.umt:29:4">To make you design an in-memory indexing scheme.
</p></li></ul></section><section data-coord="prj1.umt:32:0"><h2 data-coord="prj1.umt:32:0">Background</h2><p data-coord="prj1.umt:35:0">This project involves reading and querying blog data stored entirely
in memory.  The data is organized in three categories:
</p><dl data-coord="prj1.umt:38:0"><dt data-coord="prj1.umt:38:2"> <strong data-coord="prj1.umt:38:1">Users</strong></dt><dd data-coord="prj1.umt:40:0"><p data-coord="prj1.umt:40:4">The people associated with the blog.  Each person can
have one-or-more roles of <samp data-coord="prj1.umt:40:88">admin</samp>, <samp data-coord="prj1.umt:40:97">author</samp> or <samp data-coord="prj1.umt:40:109">commenter</samp>
(the <samp data-coord="prj1.umt:40:130">admin</samp> role is not used in this project).  Each
user is identified using an externally generated <samp data-coord="prj1.umt:40:232">id</samp>.
</p></dd><dt data-coord="prj1.umt:45:2"> <strong data-coord="prj1.umt:45:1">Articles</strong></dt><dd data-coord="prj1.umt:46:0"><p data-coord="prj1.umt:46:4">The blog articles.  Will have title and content
fields, an authorId field identifying the author and a
list of keywords. Each article is identified using
an internally generated <samp data-coord="prj1.umt:46:194">id</samp>.
</p></dd><dt data-coord="prj1.umt:51:2"> <strong data-coord="prj1.umt:51:1">Comments</strong></dt><dd data-coord="prj1.umt:52:0"><p data-coord="prj1.umt:52:4">Comments associated with each blog article.  A comment
will have associated <samp data-coord="prj1.umt:52:84">content</samp>.  A comment will be associated with
its corresponding article using its <samp data-coord="prj1.umt:52:170">articleId</samp> field and its
commenter using its <samp data-coord="prj1.umt:52:220">commenterId</samp> field. Each article is identified using
an internally generated <samp data-coord="prj1.umt:52:302">id</samp>.
</p></dd></dl><p data-coord="prj1.umt:58:0">All data item in each category have <samp data-coord="prj1.umt:58:36">creationTime</samp> and <samp data-coord="prj1.umt:58:55">updateTime</samp>
timestamps.
</p><p data-coord="prj1.umt:61:0">It is possible to perform the following actions on the blog:
</p><dl data-coord="prj1.umt:63:0"><dt data-coord="prj1.umt:63:2"> <strong data-coord="prj1.umt:63:1">Create</strong></dt><dd data-coord="prj1.umt:64:0"><p data-coord="prj1.umt:64:4">Create a data item in a specific category.
</p></dd><dt data-coord="prj1.umt:66:2"> <strong data-coord="prj1.umt:66:1">Find</strong></dt><dd data-coord="prj1.umt:67:0"><p data-coord="prj1.umt:67:4">Find zero-or-more data items in a specific category.
</p></dd><dt data-coord="prj1.umt:69:2"> <strong data-coord="prj1.umt:69:1">Remove</strong></dt><dd data-coord="prj1.umt:70:0"><p data-coord="prj1.umt:70:4">Remove a data item in a specific category.
</p></dd><dt data-coord="prj1.umt:72:2"> <strong data-coord="prj1.umt:72:1">Update</strong></dt><dd data-coord="prj1.umt:73:0"><p data-coord="prj1.umt:73:4">Update a data item in a specific category.
</p></dd><dt data-coord="prj1.umt:75:2"> <strong data-coord="prj1.umt:75:1">Clear</strong></dt><dd data-coord="prj1.umt:76:0"><p data-coord="prj1.umt:76:4">Clear all data items in all categories.
</p></dd></dl><p data-coord="prj1.umt:78:0">All of the actions (except for <samp data-coord="prj1.umt:78:31">clear</samp>) take an object as an argument
specifying the details of the action.
</p><p data-coord="prj1.umt:81:0">The data model should become absolutely clear after looking
at the provided <em data-coord="prj1.umt:81:112"><a href="./prj1-sol/meta.js?colorize=true" data-coord="prj1.umt:81:112">meta information</a></em>.
</p></section><section data-coord="prj1.umt:85:0"><h2 data-coord="prj1.umt:85:0">Requirements</h2><p data-coord="prj1.umt:89:0">You must push a <samp data-coord="prj1.umt:89:16">submit/prj1-sol</samp> directory to your <samp data-coord="prj1.umt:89:52">master</samp> branch in
your github repository such that typing <samp data-coord="prj1.umt:89:111">npm ci</samp> within that directory
is sufficient to run the project using <samp data-coord="prj1.umt:89:181">./index.js</samp>.
</p><p data-coord="prj1.umt:93:0">You are being provided with an <a href="prj1-sol/index.js?colorize=true" data-coord="prj1.umt:93:66">index.js</a> which provides the required command-line behavior.  What you
specifically need to do is add code to the provided
<a href="./prj1-sol/blog544.js?colorize=true" data-coord="prj1.umt:93:227">blog544.js</a> source file as per
the requirements in that file and the requirements in
<a href="./prj1-sol/meta.js?colorize=true" data-coord="prj1.umt:93:347">meta.js</a>
</p><p data-coord="prj1.umt:100:0">The behavior of your program is illustrated in this <em data-coord="prj1.umt:100:66"><a href="extras/LOG" data-coord="prj1.umt:100:66">annotated log</a></em>.
</p><p data-coord="prj1.umt:103:0">Additionally, your <samp data-coord="prj1.umt:103:19">submit/prj1-sol</samp> <strong data-coord="prj1.umt:103:37">must</strong> contain a <samp data-coord="prj1.umt:103:54">vm.png</samp>
image file to verify that you have set up your VM correctly.  Specifically,
the image must show a x2go client window running on your VM.  The captured
x2go window must show a terminal window containing the output
of the following commands:
</p><pre>$ hostname<span class="hl opt">;</span> hostname <span class="hl kwb">-I</span>
$ <span class="hl kwc">ls</span> ~<span class="hl opt">/</span>projects
$ <span class="hl kwc">ls</span> ~<span class="hl opt">/</span>cs544
$ <span class="hl kwc">ls</span> ~<span class="hl opt">/</span>i?<span class="hl num">44</span>
$ crontab <span class="hl kwb">-l</span> | <span class="hl kwc">tail</span> <span class="hl kwb">-3</span></pre></section><section data-coord="prj1.umt:119:0"><h2 data-coord="prj1.umt:119:0">Command Line Driver</h2><p data-coord="prj1.umt:122:0">You are being provided with a command-line driver for your
code in <a href="./prj1-sol/index.js?colorize=true" data-coord="prj1.umt:122:104">index.js.</a>  This
section documents its use.
</p><p data-coord="prj1.umt:126:0">If you invoke it without any arguments, you will receive
a usage message (in this and subsequent logs, the nodejs
warning about the experimental ESM loader is not shown):
</p><pre>$ .<span class="hl opt">/</span>index.js 
index.js <span class="hl opt">[</span><span class="hl kwb">-n</span>|<span class="hl kwb">-c</span>|<span class="hl kwb">-v</span><span class="hl opt">]</span> DATA_DIR
$ </pre><p data-coord="prj1.umt:137:0">The required <samp data-coord="prj1.umt:137:13">DATA_DIR</samp> is a directory which contains JSON
data files for loading into the blog.  Specifically,
it loads all JSON files with paths matching the following
shell wildcard pattern:
</p><pre data-coord="prj1.umt:143:0">DATA_DIR/json/{articles,comments,users}/*.json
</pre><p data-coord="prj1.umt:146:0">The options have the following effect:
</p><dl data-coord="prj1.umt:148:0"><dt data-coord="prj1.umt:148:2"> <samp data-coord="prj1.umt:148:1">-n</samp> <strong data-coord="prj1.umt:148:6">noLoad</strong> </dt><dd data-coord="prj1.umt:149:0"><p data-coord="prj1.umt:149:4">If specified, then data is not loaded from <samp data-coord="prj1.umt:149:47">DATA_DIR</samp>.
Handled entirely by <samp data-coord="prj1.umt:149:83">index.js</samp>.
</p></dd><dt data-coord="prj1.umt:152:2"> <samp data-coord="prj1.umt:152:1">-c</samp> <strong data-coord="prj1.umt:152:6">clear</strong> </dt><dd data-coord="prj1.umt:153:0"><p data-coord="prj1.umt:153:4">All data is cleared as the program starts up.
Handled entirely by <samp data-coord="prj1.umt:153:74">index.js</samp>.
Does not have any effect in this project.
</p></dd><dt data-coord="prj1.umt:157:2"> <samp data-coord="prj1.umt:157:1">-v</samp> <strong data-coord="prj1.umt:157:6">verbose</strong> </dt><dd data-coord="prj1.umt:158:0"><p data-coord="prj1.umt:158:4">Print details of the use of secondary indexes.  Specifically,
whenever a secondary index is used a line should be printed
containing the name of the indexing field, followed by a <samp data-coord="prj1.umt:158:191">:</samp>
and single space followed by a count of the number of
objects which have the search value for that field.
</p><p data-coord="prj1.umt:164:4">This option must be handled by the code you need to
implement in <samp data-coord="prj1.umt:164:73">blog544.js</samp>.
</p></dd></dl><p data-coord="prj1.umt:167:0">When the program starts up, it first prints out a help message
and starts up a <a href="https://en.wikipedia.org/wiki/Read%E2%80%93eval%E2%80%93print_loop" data-coord="prj1.umt:167:149">REPL.</a>  The help message summarizes the commands which may
be typed into the REPL:
</p><pre>$ .<span class="hl opt">/</span>index.js ~<span class="hl opt">/</span>cs544<span class="hl opt">/</span>data
create users|articles|comments NAME<span class="hl opt">=</span>VALUE...
<span class="hl kwc">clear clear</span> all blog data
<span class="hl kwc">find</span>   users|articles|comments NAME<span class="hl opt">=</span>VALUE... NAME...
<span class="hl kwb">help</span>  output this message
remove users|articles|comments NAME<span class="hl opt">=</span>VALUE...
update users|articles|comments NAME<span class="hl opt">=</span>VALUE...
<span class="hl opt">&gt;&gt;</span> </pre><p data-coord="prj1.umt:183:0">The <samp data-coord="prj1.umt:183:4">NAME=VALUE</samp> pairs must meet the requirements in
<samp data-coord="prj1.umt:183:53">meta.js</samp>.  The <samp data-coord="prj1.umt:183:69">VALUE</samp> cannot contain any whitespace,
but it may specify a list using comma-separated
values surrounded by <samp data-coord="prj1.umt:183:177">[</samp> and <samp data-coord="prj1.umt:183:185">]</samp> (useful for
typing in a value for article <samp data-coord="prj1.umt:183:231">keywords</samp>).
</p><p data-coord="prj1.umt:189:0">The <samp data-coord="prj1.umt:189:4">find</samp> command allows two additional <samp data-coord="prj1.umt:189:41">NAME</samp>s beyond
those specified in <samp data-coord="prj1.umt:189:75">meta.js</samp>:
</p><dl data-coord="prj1.umt:192:0"><dt data-coord="prj1.umt:192:2"> <samp data-coord="prj1.umt:192:1">_count</samp> </dt><dd data-coord="prj1.umt:193:0"><p data-coord="prj1.umt:193:4">A limit on the maximum number of returned objects.
It defaults to 5.  This limit will need to
be enforced by your implementation of the
<samp data-coord="prj1.umt:193:152">find()</samp> method.
</p><p data-coord="prj1.umt:198:4"><strong data-coord="prj1.umt:198:4">Bug</strong>: Currently, there is no validation for this
value.
</p></dd><dt data-coord="prj1.umt:201:2"> <samp data-coord="prj1.umt:201:1">_json</samp> </dt><dd data-coord="prj1.umt:202:0"><p data-coord="prj1.umt:202:4">Specifies a path to a JSON file which is merged into the
name/value pairs.  If no file is found at that path, then the
specified path is appended to <samp data-coord="prj1.umt:202:161">DATA_DIR</samp> and the file is looked
for at that path instead.
</p><p data-coord="prj1.umt:207:4">The <samp data-coord="prj1.umt:207:8">_json</samp> name/value pair is handled completely by
<samp data-coord="prj1.umt:207:61">index.js</samp> and will never be seen by your code.
</p></dd></dl><p data-coord="prj1.umt:210:0">Examples of the command-line interaction can be found
in the <em data-coord="prj1.umt:210:75"><a href="extras/LOG" data-coord="prj1.umt:210:75">annotated LOG</a></em>.
</p></section><section data-coord="prj1.umt:213:0"><h2 data-coord="prj1.umt:213:0">Provided Files</h2><p data-coord="prj1.umt:216:0">The <a href="./prj1-sol" data-coord="prj1.umt:216:18">prj1-sol</a> directory contains a start for your
project.  It contains the following files:
</p><dl data-coord="prj1.umt:219:0"><dt data-coord="prj1.umt:219:4"> <a href="./prj1-sol/blog544.js?colorize=true" data-coord="prj1.umt:219:40">blog544.js</a></dt><dd data-coord="prj1.umt:220:0"><p data-coord="prj1.umt:220:6">This skeleton file constitutes the guts of your project.  You
will need to flesh out the skeleton, adding code as per the
documentation.  You should feel free to add any auxiliary
function or method definitions as required.
</p></dd><dt data-coord="prj1.umt:225:4"> <a href="./prj1-sol/index.js?colorize=true" data-coord="prj1.umt:225:38">index.js</a></dt><dd data-coord="prj1.umt:226:0"><p data-coord="prj1.umt:226:6">This file provides the complete command-line behavior which is
required by your program.  It requires
<a href="./prj1-sol/blog544.js?colorize=true" data-coord="prj1.umt:226:159">blog544.js.</a>  You <strong data-coord="prj1.umt:226:176">must
      not</strong> modify this file; this ensures that your <samp data-coord="prj1.umt:226:234">Blog544</samp> class
meets its specifications and facilitates automated testing by
testing only the <samp data-coord="prj1.umt:226:341">Blog544</samp> API.
</p></dd><dt data-coord="prj1.umt:233:4"> <a href="./prj1-sol/meta.js?colorize=true" data-coord="prj1.umt:233:37">meta.js</a></dt><dd data-coord="prj1.umt:234:0"><p data-coord="prj1.umt:234:6">Meta-information about the different blog object categories.
You should not need to modify this file.
</p></dd><dt data-coord="prj1.umt:237:4"> <a href="./prj1-sol/validator.js?colorize=true" data-coord="prj1.umt:237:42">validator.js</a></dt><dd data-coord="prj1.umt:238:0"><p data-coord="prj1.umt:238:6">A validator for blog objects.  This validator handles
all validations which are dependent solely on that
object and do not depend on any other objects.
You should not need to modify this file.
</p></dd><dt data-coord="prj1.umt:243:4"> <a href="./prj1-sol/blog-error.js?colorize=true" data-coord="prj1.umt:243:43">blog-error.js</a></dt><dd data-coord="prj1.umt:244:0"><p data-coord="prj1.umt:244:6">A simple class which encapsulates an error having
a <samp data-coord="prj1.umt:244:64">code</samp> and <samp data-coord="prj1.umt:244:75">message</samp>.
You should not need to modify this file.
</p></dd><dt data-coord="prj1.umt:248:4"> <a href="./prj1-sol/README" data-coord="prj1.umt:248:22">README</a></dt><dd data-coord="prj1.umt:249:0"><p data-coord="prj1.umt:249:6">A README file which must be submitted along with your project.
It contains an initial header which you must complete (replace
the dummy entries with your name, B-number and email address at
which you would like to receive project-related email).  After
the header you may include any content which you would like read
during the grading of your project.
</p></dd></dl><p data-coord="prj1.umt:256:0">Additionally, the <em data-coord="prj1.umt:256:33"><a href="../../data/" data-coord="prj1.umt:256:33">course data directory</a></em> contains
blog data files.
</p></section><section data-coord="prj1.umt:259:0"><h2 data-coord="prj1.umt:259:0">Hints</h2><p data-coord="prj1.umt:262:0">You should feel free to use any of the functions from the standard
<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript" data-coord="prj1.umt:262:126">library;</a> in
particular, functions provided by the
<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array" data-coord="prj1.umt:262:266">Array,</a>
<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/" data-coord="prj1.umt:262:365">String,</a>
<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Set" data-coord="prj1.umt:262:461">Set</a> and
<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math" data-coord="prj1.umt:262:558">Math</a> objects may prove useful.  You should not need to use any nodejs library
functions (except possibly for
<a href="https://nodejs.org/dist/latest-v10.x/docs/api/assert.html#assert_assert_value_message" data-coord="prj1.umt:262:756">assert())</a> or additional npm packages.
</p><p data-coord="prj1.umt:277:0">The following steps are not prescriptive in that you may choose to
ignore them as long as you meet all project requirements.
</p><ol data-coord="prj1.umt:280:0"><li data-coord="prj1.umt:280:0"><p data-coord="prj1.umt:280:4">Set up your course VM as per the instructions specified in the
<em data-coord="prj1.umt:280:108"><a href="../../misc/vm-setup/vm-setup.html" data-coord="prj1.umt:280:108">VM Setup</a></em> and
<em data-coord="prj1.umt:280:166"><a href="../../misc/git-setup/git-setup.html" data-coord="prj1.umt:280:166">Git Setup</a></em> 
documents.
</p></li><li data-coord="prj1.umt:286:0"><p data-coord="prj1.umt:286:4">Read the project requirements thoroughly.  Look at the
<em data-coord="prj1.umt:286:77"><a href="extras/LOG" data-coord="prj1.umt:286:77">sample log</a></em> to make sure you understand the
necessary behavior.
</p></li><li data-coord="prj1.umt:290:0"><p data-coord="prj1.umt:290:4">Look into debugging methods for your project.  Possibilities
include:
</p><ul data-coord="prj1.umt:293:0"><li data-coord="prj1.umt:293:0"><p data-coord="prj1.umt:293:8">Logging debugging information onto the terminal using
<a href="https://developer.mozilla.org/en-US/docs/Web/API/Console/log" data-coord="prj1.umt:293:135">console.log()</a> or
<a href="https://developer.mozilla.org/en-US/docs/Web/API/Console/error" data-coord="prj1.umt:293:220">console.error().</a>
</p></li><li data-coord="prj1.umt:299:0"><p data-coord="prj1.umt:299:8">Use the chrome debugger as outlined in this
<a href="https://medium.com/@paul_irish/debugging-node-js-nightlies-with-chrome-devtools-7c4a1b95ae27" data-coord="prj1.umt:299:164">article.</a>  Specifically, use the <samp data-coord="prj1.umt:299:196">--inspect-brk</samp> node option
when starting your program and then visit <samp data-coord="prj1.umt:299:267">about://inspect</samp>
in your chrome browser.
</p><p data-coord="prj1.umt:305:1">There seems to be some problems getting all necessary
files loaded in to the chrome debugger.  This may be
due to the use of ES6 modules.  The provided <samp data-coord="prj1.umt:305:155">blog544.js</samp>
file has a commented out <samp data-coord="prj1.umt:305:194">debugger</samp> line.  If you have
problems, uncomment that line and when your program
starts up under the debugger use the <em data-coord="prj1.umt:305:315">return from current
	function</em> control until the necessary source files are
available in the debugger at which point you can insert
necessary breakpoints.
</p></li></ul></li><li data-coord="prj1.umt:315:0"><p data-coord="prj1.umt:315:4">Consider what kind of indexing structure you will need to track
the blog category.  For each category, you will need a collection
indexed by the <samp data-coord="prj1.umt:315:157">id</samp> field.  Additionally, you will need to set up
the indexes required by <a href="./prj1-sol/meta.js?colorize=true" data-coord="prj1.umt:315:272">meta.js</a>
for each category,
</p><p data-coord="prj1.umt:321:4">When designing your indexing structures, you should first think in
terms of abstract
<em data-coord="prj1.umt:321:148"><a href="https://en.wikipedia.org/wiki/Associative_array" data-coord="prj1.umt:321:148">associative
    arrays</a></em> and then consider possibilities for implementing these
abstract associative arrays in JavaScript.  Possibilities:
</p><ul data-coord="prj1.umt:327:0"><li data-coord="prj1.umt:327:0"><p data-coord="prj1.umt:327:9">Use standard JavaScript objects as associative arrays.
Advantages include the ability to using simple <samp data-coord="prj1.umt:327:120">[]</samp>-based
access and trivial JSON conversion for subsequent projects.
Disadvantages include the lack of any defined order for
property keys and the overhead of all the machinery
associated with <samp data-coord="prj1.umt:327:351">Object</samp>'s like inheritance.
</p></li><li data-coord="prj1.umt:334:0"><p data-coord="prj1.umt:334:9">Use the relatively new
<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map" data-coord="prj1.umt:334:138">Map</a> addition to the standard library.  An advantage of this
approach is that it preserves insertion order.  It may also
be lighter than the <samp data-coord="prj1.umt:334:296">Object</samp> alternative suggested above.
Disadvantages include a clumsy API (<samp data-coord="prj1.umt:334:383">get()</samp> and <samp data-coord="prj1.umt:334:395">set()</samp>)
and non-trivial work required for JSON conversion which may
be useful for subsequent projects.
</p></li></ul><p data-coord="prj1.umt:343:4">A
<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Set" data-coord="prj1.umt:343:102">Set</a> of ID's may be useful for implementing secondary indexes.
</p></li><li data-coord="prj1.umt:348:0"><p data-coord="prj1.umt:348:4">Start your project by creating a <samp data-coord="prj1.umt:348:37">submit/prj1-sol</samp> directory in a
new <samp data-coord="prj1.umt:348:78">prj1-sol</samp> branch of your <samp data-coord="prj1.umt:348:104">i444</samp> or <samp data-coord="prj1.umt:348:114">i544</samp> directory
corresponding to your github repository. Change into the newly
created <samp data-coord="prj1.umt:348:210">prj1-sol</samp> directory and initialize your project by
running <samp data-coord="prj1.umt:348:274">npm init -y</samp>.
</p><pre>    $ <span class="hl kwb">cd</span> ~<span class="hl opt">/</span>i?<span class="hl num">44</span>
    $ git checkout <span class="hl kwb">-b</span> prj1-sol <span class="hl slc">#create new branch</span>
    $ mkdir <span class="hl kwb">-p</span> submit<span class="hl opt">/</span>prj1-sol <span class="hl slc">#create new dir</span>
    $ <span class="hl kwb">cd</span> submit<span class="hl opt">/</span>prj1-sol       <span class="hl slc">#enter project dir</span>
    $ npm init <span class="hl kwb">-y</span>              <span class="hl slc">#initialize project</span></pre><p data-coord="prj1.umt:363:4">This will create a <samp data-coord="prj1.umt:363:23">package.json</samp> file; this file will be
committed to your repository in the next step.
</p></li><li data-coord="prj1.umt:366:0"><p data-coord="prj1.umt:366:4">Commit into git:
</p><pre>    $ git add package.json <span class="hl slc">#add package.json to git staging area</span>
    $ git commit <span class="hl kwb">-m</span> <span class="hl str">&apos;started prj1&apos;</span> <span class="hl slc">#commit locally</span>
    $ git push <span class="hl kwb">-u</span> origin prj1-sol <span class="hl slc">#push branch with changes</span>
                                  <span class="hl slc">#to github</span></pre></li><li data-coord="prj1.umt:377:0"><p data-coord="prj1.umt:377:4">Use your editor to add a top-level <samp data-coord="prj1.umt:377:39">"type": "module"</samp> entry
to the generated <samp data-coord="prj1.umt:377:85">package.json</samp>.  Be careful with your
syntax as JSON syntax is quite brittle; in particular,
watch your commas.
</p><p data-coord="prj1.umt:383:4">Run <samp data-coord="prj1.umt:383:8">npm install</samp>.  This should create a <samp data-coord="prj1.umt:383:45">package-lock.json</samp>.  Be
sure to commit this lock file to your github repository too.
</p><p data-coord="prj1.umt:386:4">Commit your changes:
</p><pre>    $ git add package-lock.json
    $ git commit <span class="hl kwb">-a -m</span> <span class="hl str">&apos;added package-lock&apos;</span>
    $ git push</pre></li><li data-coord="prj1.umt:395:0"><p data-coord="prj1.umt:395:4">Capture an image to validate that you have set up your course VM
as instructed.  Within a terminal window in your <samp data-coord="prj1.umt:395:122">x2go</samp> client
window, type in the following commands:
</p><pre>    $ hostname<span class="hl opt">;</span> hostname <span class="hl kwb">-I</span>
    $ <span class="hl kwc">ls</span> ~<span class="hl opt">/</span>projects
    $ <span class="hl kwc">ls</span> ~<span class="hl opt">/</span>cs544
    $ <span class="hl kwc">ls</span> ~<span class="hl opt">/</span>i?<span class="hl num">44</span>
    $ crontab <span class="hl kwb">-l</span> | <span class="hl kwc">tail</span> <span class="hl kwb">-3</span></pre><p data-coord="prj1.umt:408:4">Use an image capture program on your <strong data-coord="prj1.umt:408:41">workstation</strong> to capture an
image of your <samp data-coord="prj1.umt:408:87">x2go</samp> client window into a file <samp data-coord="prj1.umt:408:120">vm.png</samp>.  The
captured image should show the terminal window containing the
output of the above commands as part of the <samp data-coord="prj1.umt:408:249">x2go</samp> client window.
Move the <samp data-coord="prj1.umt:408:284">vm.png</samp> file from your workstation to your VM's
<samp data-coord="prj1.umt:408:337">~/?44/submit/prj1-sol</samp> directory (you can use <samp data-coord="prj1.umt:408:384">scp</samp>; if your
workstation cannot connect directly to your VM, then do a 2 step
copy using <samp data-coord="prj1.umt:408:483">remote.cs</samp> as an intermediate).
</p><p data-coord="prj1.umt:417:4">Add, commit and push the <samp data-coord="prj1.umt:417:29">vm.png</samp> file.
</p></li><li data-coord="prj1.umt:419:0"><p data-coord="prj1.umt:419:4">Copy the provided files into your project directory:
</p><pre>    $ <span class="hl kwc">cp</span> <span class="hl kwb">-p</span> <span class="hl kwd">$HOME</span><span class="hl opt">/</span>cs544<span class="hl opt">/</span>projects<span class="hl opt">/</span>prj<span class="hl num">1</span><span class="hl opt">/</span>prj1-sol<span class="hl opt">/*</span> .</pre><p data-coord="prj1.umt:426:4">This should copy the <samp data-coord="prj1.umt:426:25">README</samp> template, the <samp data-coord="prj1.umt:426:48">index.js</samp>
command-line driver, the <samp data-coord="prj1.umt:426:88">blog544.js</samp> skeleton file and the
auxiliary files <samp data-coord="prj1.umt:426:143">blog-error.js</samp>, <samp data-coord="prj1.umt:426:160">meta.js</samp> and <samp data-coord="prj1.umt:426:174">validator.js</samp> into
your project directory.
</p><p data-coord="prj1.umt:431:4">Also, use
</p><pre>    $ <span class="hl kwc">cp</span> <span class="hl kwb">-p</span> <span class="hl kwd">$HOME</span><span class="hl opt">/</span>cs544<span class="hl opt">/</span>projects<span class="hl opt">/</span>prj<span class="hl num">1</span><span class="hl opt">/</span>prj1-sol<span class="hl opt">/</span>.<span class="hl opt">*</span> .</pre><p data-coord="prj1.umt:438:4">to copy <em data-coord="prj1.umt:438:12">hidden</em> files, in particular <samp data-coord="prj1.umt:438:42">.gitignore</samp>.
</p></li><li data-coord="prj1.umt:441:0"><p data-coord="prj1.umt:441:4">You should be able to run the project, but all commands will
return without any results until you replace the @TODO sections
with suitable code.
</p><pre data-coord="prj1.umt:447:0">    $ ./index.js #show usage message
    $ ./index.js ~/cs544/dat
    (node:9810) ExperimentalWarning: The ESM...
    create users|articles|comments NAME=VALUE...
    clear clear all blog data
    find   users|articles|comments NAME=VALUE... NAME...
    help  output this message
    remove users|articles|comments NAME=VALUE...
    update users|articles|comments NAME=VALUE...
    &gt;&gt;
</pre><p data-coord="prj1.umt:459:4">In some cases, you will also get validation errors: for example
</p><pre data-coord="prj1.umt:462:0">    &gt;&gt; create users
    MISSING_FIELD: missing user ID, user email,
    user first name, user last name, user roles fields
    for users create
    &gt;&gt;    
</pre></li><li data-coord="prj1.umt:469:0"><p data-coord="prj1.umt:469:4">Replace the <samp data-coord="prj1.umt:469:16">XXX</samp> entries in the <samp data-coord="prj1.umt:469:37">README</samp> template.
</p></li><li data-coord="prj1.umt:472:0"><p data-coord="prj1.umt:472:4">Commit your project to github:
</p><pre data-coord="prj1.umt:475:0">    $ git add .
    $ git commit -a -m 'added prj1 files'
</pre></li><li data-coord="prj1.umt:479:0"><p data-coord="prj1.umt:479:4">Open the copy of the <samp data-coord="prj1.umt:479:25">blog544.js</samp> file in your project directory.
It contains
</p><ol data-coord="prj1.umt:482:0"><li data-coord="prj1.umt:482:0"><p data-coord="prj1.umt:482:8">Imports of auxiliary files.
</p></li><li data-coord="prj1.umt:484:0"><p data-coord="prj1.umt:484:8">A comment describing the data model and error codes.
</p></li><li data-coord="prj1.umt:486:0"><p data-coord="prj1.umt:486:8">The code starts out with an <samp data-coord="prj1.umt:486:36">export</samp> directive.  This
makes <samp data-coord="prj1.umt:486:76">Blog544</samp> the only symbol exported from this
file.
</p></li><li data-coord="prj1.umt:490:0"><p data-coord="prj1.umt:490:8">A skeleton <samp data-coord="prj1.umt:490:19">Blog544</samp> <samp data-coord="prj1.umt:490:29">class</samp> definition with <samp data-coord="prj1.umt:490:53">@TODO</samp> comments.
The comments and <samp data-coord="prj1.umt:490:95">meta.js</samp> specify the behavior of the methods
you need to complete.
</p><p data-coord="prj1.umt:494:8">Note that the <samp data-coord="prj1.umt:494:22">class</samp> syntax is a recent addition to
JavaScript and is syntactic sugar around JavaScript's more
flexible object model.  Note that even though the use of this
<samp data-coord="prj1.umt:494:206">class</samp> syntax may make students with a background in
class-based OOPL's feel more comfortable, there are some
differences worth pointing out:
</p><ul data-coord="prj1.umt:501:0"><li data-coord="prj1.umt:501:0"><p data-coord="prj1.umt:501:12">No data members can be defined within the <samp data-coord="prj1.umt:501:54">class</samp> body.
All "instance variables" must be referenced through the
<samp data-coord="prj1.umt:501:135">this</samp> pseudo-variable in both <samp data-coord="prj1.umt:501:166">constructor</samp> and
methods.  For example, if we want to initialize an
instance variable <samp data-coord="prj1.umt:501:263">data</samp> in the <samp data-coord="prj1.umt:501:277">constructor()</samp> we may
have a statement like:
</p><pre>            <span class="hl kwa">this</span><span class="hl opt">.</span>data <span class="hl opt">= {};</span></pre></li><li data-coord="prj1.umt:512:0"><p data-coord="prj1.umt:512:12">There is no implicit <samp data-coord="prj1.umt:512:33">this</samp>.  If an instance method
needs to call another instance method of the same object, the
method <strong data-coord="prj1.umt:512:143">must</strong> be called through <samp data-coord="prj1.umt:512:168">this</samp>.
</p></li><li data-coord="prj1.umt:516:0"><p data-coord="prj1.umt:516:12">There is no easy way to get private methods or data.
Instead a convention which is often used is to 
prefix private names with something like a underscore
and trust <samp data-coord="prj1.umt:516:192">class</samp> clients to not misuse those names.
</p></li></ul></li><li data-coord="prj1.umt:521:0"><p data-coord="prj1.umt:521:8">The class skeleton contains the 7 functions/methods you need to
implement.  These methods are:
</p><dl data-coord="prj1.umt:524:0"><dt data-coord="prj1.umt:524:3"> <samp data-coord="prj1.umt:524:1">constructor()</samp> </dt><dd data-coord="prj1.umt:525:0"><p data-coord="prj1.umt:525:5">The constructor for the class. JavaScript requires
the name.  You may change the parameter list.  Note
that it creates a validator.
</p></dd><dt data-coord="prj1.umt:529:10"> <samp data-coord="prj1.umt:529:1">make()</samp></dt><dd data-coord="prj1.umt:530:0"><p data-coord="prj1.umt:530:5">A static factory method which invokes the constructor.
This is how <samp data-coord="prj1.umt:530:77">Blog544</samp> instances will be constructed
externally.
</p></dd><dt data-coord="prj1.umt:534:10"> <samp data-coord="prj1.umt:534:1">clear()</samp></dt><dd data-coord="prj1.umt:535:0"><p data-coord="prj1.umt:535:5">A simple method which should clear out all the data
stored within the invoking instance of the <samp data-coord="prj1.umt:535:105">Blog544</samp>
<samp data-coord="prj1.umt:535:120">class</samp>.
</p></dd><dt data-coord="prj1.umt:539:3"> <samp data-coord="prj1.umt:539:1">create()</samp>, <samp data-coord="prj1.umt:539:13">find()</samp>, <samp data-coord="prj1.umt:539:23">update()</samp>, <samp data-coord="prj1.umt:539:35">remove()</samp></dt><dd data-coord="prj1.umt:540:0"><p data-coord="prj1.umt:540:5">The main methods you need to implement.
</p><p data-coord="prj1.umt:542:12">Note that the provided skeletons for these functions
already contains partial validation code.  This code
checks for required/forbidden values, converts strings to
<samp data-coord="prj1.umt:542:191">Date</samp>'s as necessary, inserts default values.  The
validation is driven by the table in the <samp data-coord="prj1.umt:542:289">meta.js</samp> file
which was provided as an argument to the <samp data-coord="prj1.umt:542:350">make()</samp> factory
function.  Note that though this generic validation takes
care of most of your validation needs, you will still need
some additional validation. In particular, you will need
to handle the situations documented at the start of the
file for <samp data-coord="prj1.umt:542:631">BAD_ID</samp> and <samp data-coord="prj1.umt:542:644">EXISTS</samp>.
</p></dd></dl></li></ol><p data-coord="prj1.umt:554:4">Some points worth making about the provided code:
</p><ul data-coord="prj1.umt:556:0"><li data-coord="prj1.umt:556:0"><p data-coord="prj1.umt:556:8">All the methods have been declared <samp data-coord="prj1.umt:556:43">async</samp>.  This is not
needed for this project, but will be necessary for subsequent
projects.  You can safely ignore the <samp data-coord="prj1.umt:556:173">async</samp> declarations and
write code normally.
</p></li><li data-coord="prj1.umt:561:0"><p data-coord="prj1.umt:561:8">For error handling, the convention used is that all user
errors should be thrown as lists of <samp data-coord="prj1.umt:561:109">BlogError</samp> objects (for example,
see the code at the end of the <samp data-coord="prj1.umt:561:175">validate()</samp> method of the
<a href="prj1-sol/validator.js?colorize=true" data-coord="prj1.umt:561:242">Validator</a> <samp data-coord="prj1.umt:561:252">class</samp>).
If you need to <samp data-coord="prj1.umt:561:278">throw</samp> your own errors, be sure to wrap
them in a list.  Do so even for a single error:
</p><pre>        <span class="hl kwa">if</span> <span class="hl opt">(</span><span class="hl kwa">this</span><span class="hl opt">.</span><span class="hl kwd">find</span><span class="hl opt">(</span>category<span class="hl opt">, {</span> id<span class="hl opt">:</span> obj<span class="hl opt">.</span>id<span class="hl opt">}).</span>length <span class="hl opt">&gt;</span> <span class="hl num">0</span><span class="hl opt">) {</span>
          <span class="hl kwb">const</span> msg <span class="hl opt">=</span>
            `object with id $<span class="hl opt">{</span>obj<span class="hl opt">.</span>id<span class="hl opt">}</span> already exists <span class="hl kwa">for</span> $<span class="hl opt">{</span>category<span class="hl opt">}</span>`<span class="hl opt">;</span>
          <span class="hl kwa">throw</span> <span class="hl opt">[</span> <span class="hl kwa">new</span> <span class="hl kwd">BlogError</span><span class="hl opt">(</span><span class="hl str">&apos;EXISTS&apos;</span><span class="hl opt">,</span> msg<span class="hl opt">) ];</span>
        <span class="hl opt">}</span></pre><p data-coord="prj1.umt:576:8">This allows the calling code to distinguish between
exceptions caused by intentional error reporting and
those caused inadvertently, allowing the former
to be reported as simple error messages whereas the
latter will be reported with a full stack trace.  This
makes it much easier to debug your code when you get
unintentional exceptions.
</p></li><li data-coord="prj1.umt:584:0"><p data-coord="prj1.umt:584:8">The code should assume that the property values in the
incoming <samp data-coord="prj1.umt:584:80">*Specs</samp> object which is the argument to the methods in
<samp data-coord="prj1.umt:584:144">Blog544</samp> <strong data-coord="prj1.umt:584:154">can</strong> be <samp data-coord="prj1.umt:584:163">String</samp>'s, even when the corresponding
property is expected to be a <samp data-coord="prj1.umt:584:240">Date</samp>.  For example,
a <samp data-coord="prj1.umt:584:272">creationTime</samp> may come in as:
</p><pre>        <span class="hl opt">{ ...</span>
          creationTime<span class="hl opt">:</span> <span class="hl str">&quot;2019-08-22T12:02Z&quot;</span><span class="hl opt">,</span>
          <span class="hl opt">...</span>
        <span class="hl opt">}</span></pre><p data-coord="prj1.umt:597:1">This assumption makes it easy to interface with dumb
form interfaces (or a dumb cli program for this project).
</p><p data-coord="prj1.umt:600:1">This possibility is handled correctly by the
provided validation code with the validation
code return value containing the property as a <samp data-coord="prj1.umt:600:140">Date</samp>.
</p></li><li data-coord="prj1.umt:604:0"><p data-coord="prj1.umt:604:8">In contrast to the previous point, any date-valued
properties in the return values of the <samp data-coord="prj1.umt:604:106">Blog544</samp> methods
should be JavaScript <samp data-coord="prj1.umt:604:153">Date</samp>'s.
</p></li></ul></li><li data-coord="prj1.umt:608:0"><p data-coord="prj1.umt:608:4">Add initialization code to your <samp data-coord="prj1.umt:608:36">make()</samp> factory function and
<samp data-coord="prj1.umt:608:70">constructor()</samp>.  This will set up the necessary indexing
structures to handle the requirements for this class.
</p><p data-coord="prj1.umt:612:4">There are two approaches you can take to building up your
indexing structures:
</p><ol data-coord="prj1.umt:615:0"><li data-coord="prj1.umt:615:0"><p data-coord="prj1.umt:615:8">A data-driven approach driven entirely by the <samp data-coord="prj1.umt:615:54">meta</samp>
information provided to your class.  This is the approach
taken by the validation code in the
<a href="prj1-sol/validator.js?colorize=true" data-coord="prj1.umt:615:218">Validator</a> <samp data-coord="prj1.umt:615:228">class</samp>.
</p></li><li data-coord="prj1.umt:620:0"><p data-coord="prj1.umt:620:8">A hard-coded approach.  You can regard the <samp data-coord="prj1.umt:620:51">meta</samp>
information simply as documentation and hard-code
the indexing structures into your code.
</p></li></ol><p data-coord="prj1.umt:624:4">To start with, it may be a good idea to merely index by <samp data-coord="prj1.umt:624:60">id</samp> and
not worry about the secondary indexes required by
<a href="./prj1-sol/meta.js?colorize=true" data-coord="prj1.umt:624:163">meta.js.</a>  Specifically for
each category, you will need to maintain mappings between ID's and
their corresponding objects.
</p></li><li data-coord="prj1.umt:630:0"><p data-coord="prj1.umt:630:4">Add code for the <samp data-coord="prj1.umt:630:21">create()</samp> method.  If you are ignoring secondary
indexes, you will merely need to add the validated object to your
primary index for that category.
</p><p data-coord="prj1.umt:634:4">The <samp data-coord="prj1.umt:634:8">create()</samp> method is responsible for generating IDs for the
<samp data-coord="prj1.umt:634:72">articles</samp> and <samp data-coord="prj1.umt:634:87">comments</samp> category.  This can be relegated to a
utility method.  The requirements for the generated id include:
</p><ul data-coord="prj1.umt:638:0"><li data-coord="prj1.umt:638:0"><p data-coord="prj1.umt:638:8">It obviously needs to be unique for a specified category.
</p></li><li data-coord="prj1.umt:640:0"><p data-coord="prj1.umt:640:8">Given a specific ID, other ID's should not be easily
guessable.  That precludes using a simple sequence of numbers.
</p></li></ul><p data-coord="prj1.umt:643:4">If you decide to use JavaScript's builtin
<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math/random" data-coord="prj1.umt:643:150">Math.random(),</a> you will receive different ID's each time you run
your program.  You can avoid this by using an undocumented nodejs
option <samp data-coord="prj1.umt:643:296">--random-seed</samp> to provide an initial seed for the random
number generator using something like <samp data-coord="prj1.umt:643:396">--random-seed=1</samp>.
</p><p data-coord="prj1.umt:650:4">Utility functions like generating ID's do not need access to an
instance of <samp data-coord="prj1.umt:650:84">Blog544</samp>.  One alternative is that they could be
defined as "private" <samp data-coord="prj1.umt:650:160">static</samp> methods.  A better alternative is
to define them as functions outside the <samp data-coord="prj1.umt:650:247">class</samp> with the advantage
of true privacy and not needing to precede each invocation by the
class name.
</p><p data-coord="prj1.umt:657:4">You should now be able to test your <samp data-coord="prj1.umt:657:40">create()</samp> with the
command-line program which creates instances of blog objects from
the <a href="../../data/json" data-coord="prj1.umt:657:157">data</a> directory.
</p></li><li data-coord="prj1.umt:661:0"><p data-coord="prj1.umt:661:4">Implement your <samp data-coord="prj1.umt:661:19">find()</samp> method.  For now, simply ensure that
you can <samp data-coord="prj1.umt:661:77">find()</samp> by ID.  Test.
</p></li><li data-coord="prj1.umt:664:0"><p data-coord="prj1.umt:664:4">Add code to your <samp data-coord="prj1.umt:664:21">create()</samp> method to use your <samp data-coord="prj1.umt:664:51">find()</samp> method
to check for <samp data-coord="prj1.umt:664:84">EXISTS</samp> errors.  Test.
</p></li><li data-coord="prj1.umt:667:0"><p data-coord="prj1.umt:667:4">Add code to your <samp data-coord="prj1.umt:667:21">create()</samp> method to verify that the objects in
other categories referenced by a field's <samp data-coord="prj1.umt:667:114">identifies</samp> property
really do exist.  Test.
</p></li><li data-coord="prj1.umt:671:0"><p data-coord="prj1.umt:671:4">Implement your <samp data-coord="prj1.umt:671:19">update()</samp> method.  Test.
</p></li><li data-coord="prj1.umt:673:0"><p data-coord="prj1.umt:673:4">Implement your <samp data-coord="prj1.umt:673:19">remove()</samp> method.  Be sure to use your <samp data-coord="prj1.umt:673:59">find()</samp>
method to validate that the object about to be removed is
not referenced by objects of other categories.  Test,
</p></li><li data-coord="prj1.umt:677:0"><p data-coord="prj1.umt:677:4">Add secondary indexes.  If the <samp data-coord="prj1.umt:677:35">verbose</samp> option has been
specified, print out a line containing the name of
secondary index field and number of matching objects
when ever the secondary index is used.
</p><p data-coord="prj1.umt:682:4">Certain checks are necessary when dealing with secondary
indexes:
</p><ul data-coord="prj1.umt:685:0"><li data-coord="prj1.umt:685:0"><p data-coord="prj1.umt:685:6">When you remove an object, it needs to be removed
from all indexes referring to it.
</p></li><li data-coord="prj1.umt:688:0"><p data-coord="prj1.umt:688:6">When you update an object, you need to ensure that the object is
removed from any secondary indexes for its old values and added
to the secondary indexes for its new values.  For example, if
you update a user <samp data-coord="prj1.umt:688:233">email</samp> field, then you need to ensure that
the user is removed from the index for the previous value of the
<samp data-coord="prj1.umt:688:354">email</samp> and added into the index for the new value of the <samp data-coord="prj1.umt:688:412">email</samp>.
</p></li></ul></li><li data-coord="prj1.umt:695:0"><p data-coord="prj1.umt:695:4">Iterate until you meet all requirements.  
</p></li></ol><p data-coord="prj1.umt:697:0">It is a good idea to commit and push your project periodically
whenever you have made significant changes.  When it is complete
please follow the procedure given in the
<em data-coord="prj1.umt:697:219"><a href="../../misc/git-setup/git-setup.html#prj-submit" data-coord="prj1.umt:697:219">git setup</a></em> document
to submit your project to the TA via github.
</p></section></section>
    </div> <!-- #content -->
  </body>
</html>
